[["representation.html", "Chapter 5 Representation 5.1 Corpus-dataframe 5.2 Doc-Term-Pair (unnested) 5.3 Doc-Term-Count (Term-Doc) 5.4 Doc-Doc-Count 5.5 Term-Term-Count 5.6 Pivot-wide-to-matrix 5.7 tidytext-to-matrix 5.8 Dimension Reduction", " Chapter 5 Representation library(stringr) library(tidytext) 5.1 Corpus-dataframe text &lt;- c(&quot;我家狗兒最愛睡覺&quot;, &quot;我家貓兒最愛睡覺&quot;, &quot;所有貓兒天生就會跑&quot;, &quot;所有狗兒天生就會跑&quot;, &quot;所有鳥兒天生就會飛&quot;, &quot;我家狗兒老是汪汪叫&quot;, &quot;我家貓兒老是喵喵叫&quot;, &quot;我家鳥兒老是啾啾叫&quot;) corpus.df &lt;- data.frame(text) %&gt;% mutate(doc_id = paste0(&quot;doc&quot;, 1:n())) library(jiebaR) cutter &lt;- worker() segment_not &lt;- c(&quot;喵喵&quot;, &quot;啾啾&quot;, &quot;汪汪&quot;, &quot;老是&quot;, &quot;就會&quot;) new_user_word(cutter, segment_not) ## [1] TRUE 5.2 Doc-Term-Pair (unnested) unnested.df &lt;- corpus.df %&gt;% mutate(word = purrr::map(text, function(x)segment(x, cutter))) %&gt;% unnest(word) unnested.df ## # A tibble: 23 × 3 ## text doc_id word ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 狗兒會睡覺 doc1 狗兒 ## 2 狗兒會睡覺 doc1 會 ## 3 狗兒會睡覺 doc1 睡覺 ## 4 貓兒會睡覺 doc2 貓兒 ## 5 貓兒會睡覺 doc2 會 ## 6 貓兒會睡覺 doc2 睡覺 ## 7 貓兒會跑 doc3 貓兒 ## 8 貓兒會跑 doc3 會 ## 9 貓兒會跑 doc3 跑 ## 10 狗兒會跑 doc4 狗兒 ## # … with 13 more rows 5.3 Doc-Term-Count (Term-Doc) dtcount &lt;- unnested.df %&gt;% count(doc_id, word, sort = T) dtcount ## # A tibble: 23 × 3 ## doc_id word n ## &lt;chr&gt; &lt;chr&gt; &lt;int&gt; ## 1 doc1 狗兒 1 ## 2 doc1 會 1 ## 3 doc1 睡覺 1 ## 4 doc2 會 1 ## 5 doc2 貓兒 1 ## 6 doc2 睡覺 1 ## 7 doc3 會 1 ## 8 doc3 貓兒 1 ## 9 doc3 跑 1 ## 10 doc4 狗兒 1 ## # … with 13 more rows 5.4 Doc-Doc-Count ddcount &lt;- unnested.df %&gt;% widyr::pairwise_count(doc_id, word) ddcount ## # A tibble: 28 × 3 ## item1 item2 n ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 doc2 doc1 2 ## 2 doc3 doc1 1 ## 3 doc4 doc1 2 ## 4 doc6 doc1 1 ## 5 doc1 doc2 2 ## 6 doc3 doc2 2 ## 7 doc4 doc2 1 ## 8 doc7 doc2 1 ## 9 doc1 doc3 1 ## 10 doc2 doc3 2 ## # … with 18 more rows 5.5 Term-Term-Count 5.5.1 Term-Term-Count-by-Collocation library(widyr) ttcount_collocate &lt;- unnested.df %&gt;% widyr::pairwise_count(word, doc_id) ttcount_collocate ## # A tibble: 36 × 3 ## item1 item2 n ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 會 狗兒 2 ## 2 睡覺 狗兒 1 ## 3 跑 狗兒 1 ## 4 汪汪 狗兒 1 ## 5 叫 狗兒 1 ## 6 狗兒 會 2 ## 7 睡覺 會 2 ## 8 貓兒 會 2 ## 9 跑 會 2 ## 10 狗兒 睡覺 1 ## # … with 26 more rows 5.5.2 Term-Term-Count-by-bigram ttcount_bigram &lt;- unnested.df %&gt;% group_by(doc_id) %&gt;% mutate(w2 = lead(word, 1)) %&gt;% drop_na(w2) %&gt;% ungroup() %&gt;% rename(w1 = word) %&gt;% bind_rows(data.frame(w1 = .$w2, w2 = .$w1)) %&gt;% count(w1, w2) ttcount_bigram ## # A tibble: 22 × 3 ## w1 w2 n ## &lt;chr&gt; &lt;chr&gt; &lt;int&gt; ## 1 狗兒 會 2 ## 2 狗兒 汪汪 1 ## 3 會 狗兒 2 ## 4 會 貓兒 2 ## 5 會 跑 2 ## 6 會 睡覺 2 ## 7 會飛 鳥兒 1 ## 8 叫 啾啾 1 ## 9 叫 喵喵 1 ## 10 叫 汪汪 1 ## # … with 12 more rows 5.6 Pivot-wide-to-matrix 5.6.1 Doc-Term-Matrix-tidy dtm_tidy &lt;- unnested.df %&gt;% count(doc_id, word, sort = T) %&gt;% pivot_wider(names_from = word, values_from = n, values_fill=0) %&gt;% as.data.frame() %&gt;% `rownames&lt;-`(.$doc_id) %&gt;% select(-doc_id) dtm_tidy ## 狗兒 會 睡覺 貓兒 跑 會飛 鳥兒 叫 汪汪 喵喵 啾啾 ## doc1 1 1 1 0 0 0 0 0 0 0 0 ## doc2 0 1 1 1 0 0 0 0 0 0 0 ## doc3 0 1 0 1 1 0 0 0 0 0 0 ## doc4 1 1 0 0 1 0 0 0 0 0 0 ## doc5 0 0 0 0 0 1 1 0 0 0 0 ## doc6 1 0 0 0 0 0 0 1 1 0 0 ## doc7 0 0 0 1 0 0 0 1 0 1 0 ## doc8 0 0 0 0 0 0 1 1 0 0 1 5.6.2 Term-Document-Matrix-tidy tdm_tidy &lt;- unnested.df %&gt;% count(doc_id, word, sort = T) %&gt;% pivot_wider(names_from = doc_id, values_from = n, values_fill=0) %&gt;% as.data.frame() %&gt;% `rownames&lt;-`(.$word) %&gt;% select(-word) tdm_tidy ## doc1 doc2 doc3 doc4 doc5 doc6 doc7 doc8 ## 狗兒 1 0 0 1 0 1 0 0 ## 會 1 1 1 1 0 0 0 0 ## 睡覺 1 1 0 0 0 0 0 0 ## 貓兒 0 1 1 0 0 0 1 0 ## 跑 0 0 1 1 0 0 0 0 ## 會飛 0 0 0 0 1 0 0 0 ## 鳥兒 0 0 0 0 1 0 0 1 ## 叫 0 0 0 0 0 1 1 1 ## 汪汪 0 0 0 0 0 1 0 0 ## 喵喵 0 0 0 0 0 0 1 0 ## 啾啾 0 0 0 0 0 0 0 1 5.6.3 Term-Term-Matrix affmatrix &lt;- ttcount_bigram %&gt;% pivot_wider(names_from = w2, values_from = n, values_fill = 0) %&gt;% as.data.frame() %&gt;% `rownames&lt;-`(.$w1) %&gt;% select(-w1) 5.7 tidytext-to-matrix 5.7.1 sparse(ttm) library(tidytext) sparse_ttm &lt;- ttcount_bigram %&gt;% tidytext::cast_sparse(w1, w2, n) sparse_ttm ## 11 x 11 sparse Matrix of class &quot;dgCMatrix&quot; ## ## 狗兒 2 1 1 1 . . . . . . . ## 會 . . 2 . 2 2 2 . . . . ## 會飛 . . . . 1 . . 1 . . . ## 叫 . . . 1 . 1 . 1 1 1 . ## 啾啾 . . . . . . . 1 . . 1 ## 貓兒 2 . . . . . 2 . . 1 1 ## 喵喵 . . . . . 1 . . . . 1 ## 鳥兒 . 1 1 . . . . . 1 . 1 ## 跑 2 . . . 1 . . 1 . . . ## 睡覺 2 . . . . 2 . . . . . ## 汪汪 . . . . 1 . . . . . 1 5.7.2 dfm dfm &lt;- dtcount %&gt;% tidytext::cast_dfm(doc_id, word, n) dfm ## Document-feature matrix of: 8 documents, 11 features (73.86% sparse) and 0 docvars. ## features ## docs 狗兒 會 睡覺 貓兒 跑 會飛 鳥兒 叫 汪汪 喵喵 ## doc1 1 1 1 0 0 0 0 0 0 0 ## doc2 0 1 1 1 0 0 0 0 0 0 ## doc3 0 1 0 1 1 0 0 0 0 0 ## doc4 1 1 0 0 1 0 0 0 0 0 ## doc5 0 0 0 0 0 1 1 0 0 0 ## doc6 1 0 0 0 0 0 0 1 1 0 ## [ reached max_ndoc ... 2 more documents, reached max_nfeat ... 1 more feature ] 5.7.3 dtm dtm &lt;- dtcount %&gt;% tidytext::cast_dtm(doc_id, word, n) dtm ## &lt;&lt;DocumentTermMatrix (documents: 8, terms: 11)&gt;&gt; ## Non-/sparse entries: 23/65 ## Sparsity : 74% ## Maximal term length: 2 ## Weighting : term frequency (tf) 5.7.4 tdm tdm &lt;- dtcount %&gt;% tidytext::cast_tdm(word, doc_id, n) tdm ## &lt;&lt;TermDocumentMatrix (terms: 11, documents: 8)&gt;&gt; ## Non-/sparse entries: 23/65 ## Sparsity : 74% ## Maximal term length: 2 ## Weighting : term frequency (tf) 5.8 Dimension Reduction 5.8.1 t-SNE on tt affmatrix library(tsne) tsne.affmatrix &lt;- tsne(affmatrix, initial_config = NULL, k = 2, initial_dims = 30, perplexity = 30, max_iter = 100, min_cost = 0, epoch_callback = NULL, whiten = TRUE, epoch=20) tsne.affmatrix ## [,1] [,2] ## [1,] -180.02706 54.49099 ## [2,] 2184.25869 -199.80473 ## [3,] 295.17863 488.31992 ## [4,] 72.47130 -97.67323 ## [5,] -1243.98331 -218.05268 ## [6,] 1059.11176 -144.26510 ## [7,] -2130.58637 99.27335 ## [8,] 110.59804 67.56151 ## [9,] -78.73212 -139.41877 ## [10,] -67.62589 -15.21085 ## [11,] -20.66365 104.77959 th &lt;- theme_minimal() + theme(title = element_text(family = &quot;Heiti TC Light&quot;), text = element_text(family = &quot;Heiti TC Light&quot;)) as.data.frame(tsne.affmatrix) %&gt;% bind_cols(data.frame(name = rownames(affmatrix))) %&gt;% ggplot(aes(V1, V2, label = name)) + geom_jitter(alpha = 0.1, color = &quot;blue&quot;) + geom_text(aes(label = name, family = &quot;Heiti TC Light&quot;), hjust=0, vjust=0, size = 4, alpha = 0.5) + theme_minimal() 5.8.2 t-SNE on tdm-tidy tsne.tdmtidy &lt;- tsne(tdm_tidy, initial_config = NULL, k = 2, initial_dims = 30, perplexity = 30, max_iter = 100, min_cost = 0, epoch_callback = NULL, whiten = TRUE, epoch=20) tsne.tdmtidy ## [,1] [,2] ## [1,] -105.60122 -13.872600 ## [2,] -61.78977 -11.807252 ## [3,] -975.39621 -586.363895 ## [4,] -82.71547 8.556449 ## [5,] 1344.91596 293.365106 ## [6,] -127.48003 -42.379301 ## [7,] -126.63305 6.613439 ## [8,] -227.72175 -88.731910 ## [9,] 510.25223 442.441352 ## [10,] -71.41281 -41.328900 ## [11,] -76.41787 33.507514 as.data.frame(tsne.tdmtidy) %&gt;% bind_cols(data.frame(name = rownames(tdm_tidy))) %&gt;% ggplot(aes(V1, V2, label = name)) + geom_jitter(alpha = 0.1, color = &quot;blue&quot;) + geom_text(aes(label = name, family = &quot;Heiti TC Light&quot;), hjust=0, vjust=0, size = 4, alpha = 0.5) + theme_minimal() 5.8.3 SVD on affmatrix m.svd &lt;- svd(affmatrix) # D &lt;- diag(m.svd$d) # m.svd$u %*% D %*% t(m.svd$v) # X = U D V&#39; ds &lt;- diag(1/m.svd$d[1:3]) u &lt;- m.svd$u v &lt;- m.svd$v us &lt;- as.matrix(u[, 1:3]) vs &lt;- as.matrix(v[, 1:3]) (m.ginv &lt;- vs %*% ds %*% t(us)) ## [,1] [,2] [,3] [,4] [,5] ## [1,] 0.120614363 -0.089721209 -0.008222734 0.018471534 0.011481087 ## [2,] 0.014921607 -0.008222734 -0.002960170 -0.010419551 0.004397012 ## [3,] -0.017753911 0.109502390 0.011550361 -0.003687427 0.004358705 ## [4,] 0.020192669 -0.012971698 0.004557535 0.035237247 -0.005044012 ## [5,] -0.021835960 0.120614363 0.014921607 0.008135661 0.001713732 ## [6,] 0.001574489 0.112266218 0.035101575 0.128728838 -0.021317289 ## [7,] -0.007551848 0.104599655 -0.002860689 -0.080981933 0.022886292 ## [8,] 0.018538218 -0.003188655 0.006427480 0.039619690 -0.005705802 ## [9,] 0.001713732 0.011481087 0.004397012 0.017832904 -0.002939496 ## [10,] 0.016054232 -0.003196673 -0.002728251 -0.012112178 0.005272039 ## [11,] 0.008135661 0.018471534 -0.010419551 -0.069354249 0.017832904 ## [,6] [,7] [,8] [,9] [,10] ## [1,] 0.112266218 -0.003196673 -0.003188655 0.109502390 0.104599655 ## [2,] 0.035101575 -0.002728251 0.006427480 0.011550361 -0.002860689 ## [3,] 0.021976105 0.012298942 0.022657530 -0.016031295 -0.019199254 ## [4,] -0.031295193 0.006532805 -0.015690612 0.023407137 0.057238335 ## [5,] 0.001574489 0.016054232 0.018538218 -0.017753911 -0.007551848 ## [6,] -0.158347905 0.041362300 -0.036889137 0.021976105 0.157313188 ## [7,] 0.157313188 -0.004346598 0.061309528 -0.019199254 -0.108017077 ## [8,] -0.036889137 0.008627792 -0.015970564 0.022657530 0.061309528 ## [9,] -0.021317289 0.005272039 -0.005705802 0.004358705 0.022886292 ## [10,] 0.041362300 -0.002420348 0.008627792 0.012298942 -0.004346598 ## [11,] 0.128728838 -0.012112178 0.039619690 -0.003687427 -0.080981933 ## [,11] ## [1,] -0.012971698 ## [2,] 0.004557535 ## [3,] 0.023407137 ## [4,] -0.015721576 ## [5,] 0.020192669 ## [6,] -0.031295193 ## [7,] 0.057238335 ## [8,] -0.015690612 ## [9,] -0.005044012 ## [10,] 0.006532805 ## [11,] 0.035237247 plot(m.svd$v, type=&quot;n&quot;) text(m.svd$v[,1], m.svd$v[,2], labels=rownames(affmatrix), cex= 1.5, family=&quot;Heiti TC Light&quot;) plot(m.ginv, type=&quot;n&quot;) text(m.ginv[,1], m.ginv[,2], labels=rownames(affmatrix), cex= 1.5, family=&quot;Heiti TC Light&quot;) 5.8.4 SVD on sparse_ttm m.svd &lt;- svd(sparse_ttm) D &lt;- diag(m.svd$d) m.svd$u %*% D %*% t(m.svd$v) # X = U D V&#39; ## [,1] [,2] ## [1,] 1.9999999999999984456878 0.99999999999999855671007 ## [2,] 0.0000000000000036225363 0.00000000000000091246455 ## [3,] 0.0000000000000002289835 -0.00000000000000002775558 ## [4,] 0.0000000000000003365364 -0.00000000000000024633073 ## [5,] -0.0000000000000001595946 -0.00000000000000005551115 ## [6,] 1.9999999999999982236432 0.00000000000000030184188 ## [7,] 0.0000000000000002966377 0.00000000000000074246165 ## [8,] 0.0000000000000005134781 0.99999999999999933386619 ## [9,] 1.9999999999999991118216 -0.00000000000000047184479 ## [10,] 1.9999999999999993338662 -0.00000000000000028102520 ## [11,] 0.0000000000000006375109 -0.00000000000000039898640 ## [,3] [,4] ## [1,] 1.0000000000000004440892 0.9999999999999992228439 ## [2,] 1.9999999999999997779554 0.0000000000000002563054 ## [3,] -0.0000000000000004857226 0.0000000000000004371503 ## [4,] -0.0000000000000006661338 0.9999999999999986677324 ## [5,] 0.0000000000000001712346 0.0000000000000004463270 ## [6,] 0.0000000000000014051260 0.0000000000000005728924 ## [7,] -0.0000000000000003893067 0.0000000000000008949786 ## [8,] 0.9999999999999993338662 -0.0000000000000007071167 ## [9,] 0.0000000000000005504104 -0.0000000000000002936713 ## [10,] 0.0000000000000002024596 -0.0000000000000007163714 ## [11,] -0.0000000000000011697067 0.0000000000000002598442 ## [,5] [,6] ## [1,] -0.0000000000000005767956 -0.000000000000000055944832 ## [2,] 1.9999999999999984456878 1.999999999999999111821580 ## [3,] 0.9999999999999994448885 -0.000000000000000503069808 ## [4,] -0.0000000000000006192963 0.999999999999999888977698 ## [5,] -0.0000000000000003799044 0.000000000000000208166817 ## [6,] 0.0000000000000019160021 -0.000000000000000955832635 ## [7,] -0.0000000000000006804453 1.000000000000000666133815 ## [8,] -0.0000000000000004586175 -0.000000000000000009107298 ## [9,] 1.0000000000000006661338 0.000000000000000140512602 ## [10,] -0.0000000000000004427882 2.000000000000000888178420 ## [11,] 1.0000000000000006661338 -0.000000000000000301408204 ## [,7] [,8] ## [1,] 0.00000000000000019905952 0.00000000000000003035766 ## [2,] 1.99999999999999933386619 0.00000000000000006028164 ## [3,] -0.00000000000000002428613 1.00000000000000022204460 ## [4,] 0.00000000000000002428613 1.00000000000000000000000 ## [5,] 0.00000000000000005427946 0.99999999999999966693309 ## [6,] 1.99999999999999977795540 -0.00000000000000019775848 ## [7,] -0.00000000000000091260326 -0.00000000000000032807958 ## [8,] 0.00000000000000087343327 0.00000000000000025999168 ## [9,] 0.00000000000000039848336 0.99999999999999877875467 ## [10,] -0.00000000000000040368753 0.00000000000000037600131 ## [11,] 0.00000000000000025030322 0.00000000000000023700659 ## [,9] [,10] ## [1,] 0.0000000000000002749537 0.000000000000000047271215 ## [2,] -0.0000000000000007077672 0.000000000000000223345648 ## [3,] 0.0000000000000012351231 0.000000000000000662664368 ## [4,] 1.0000000000000000000000 0.999999999999999666933093 ## [5,] 0.0000000000000004237756 0.000000000000000057974528 ## [6,] 0.0000000000000010616508 0.999999999999999222843883 ## [7,] 0.0000000000000005974735 0.000000000000000411406880 ## [8,] 0.9999999999999994448885 -0.000000000000000121430643 ## [9,] -0.0000000000000003075491 -0.000000000000000002463377 ## [10,] -0.0000000000000001937860 -0.000000000000000236061101 ## [11,] -0.0000000000000001738367 0.000000000000000375428924 ## [,11] ## [1,] 0.0000000000000005711577 ## [2,] 0.0000000000000001795439 ## [3,] 0.0000000000000001110223 ## [4,] 0.0000000000000011973929 ## [5,] 0.9999999999999996669331 ## [6,] 0.9999999999999992228439 ## [7,] 0.9999999999999998889777 ## [8,] 0.9999999999999991118216 ## [9,] -0.0000000000000009939966 ## [10,] 0.0000000000000003443426 ## [11,] 0.9999999999999988897770 plot(m.svd$v, type=&quot;n&quot;) text(m.svd$v[,1], m.svd$v[,2], labels=rownames(affmatrix), cex= 1.5, family=&quot;Heiti TC Light&quot;) 5.8.5 SVD on tdm m.svd &lt;- svd(tdm) D &lt;- diag(m.svd$d) m.svd$u %*% D %*% t(m.svd$v) # X = U D V&#39; ## [,1] [,2] ## [1,] 1.00000000000000000000000 0.00000000000000016075728 ## [2,] 1.00000000000000044408921 1.00000000000000044408921 ## [3,] 1.00000000000000000000000 0.99999999999999977795540 ## [4,] -0.00000000000000052157976 0.99999999999999988897770 ## [5,] 0.00000000000000016421142 -0.00000000000000028607574 ## [6,] 0.00000000000000017329721 0.00000000000000014589191 ## [7,] 0.00000000000000024568749 0.00000000000000005268495 ## [8,] -0.00000000000000025288919 -0.00000000000000036640709 ## [9,] 0.00000000000000025433776 -0.00000000000000033760449 ## [10,] -0.00000000000000057832951 -0.00000000000000014331546 ## [11,] 0.00000000000000006793661 0.00000000000000005696348 ## [,3] [,4] ## [1,] 0.00000000000000004740954 0.999999999999999777955395 ## [2,] 1.00000000000000044408921 1.000000000000000222044605 ## [3,] 0.00000000000000040571289 0.000000000000000003681852 ## [4,] 0.99999999999999988897770 -0.000000000000000311087509 ## [5,] 1.00000000000000000000000 1.000000000000000222044605 ## [6,] -0.00000000000000038303609 -0.000000000000000109625374 ## [7,] -0.00000000000000086124330 -0.000000000000000254183897 ## [8,] -0.00000000000000038529989 -0.000000000000000515021598 ## [9,] -0.00000000000000021750702 -0.000000000000000226582188 ## [10,] 0.00000000000000017107104 0.000000000000000189751447 ## [11,] -0.00000000000000040276475 -0.000000000000000252960722 ## [,5] [,6] ## [1,] -0.00000000000000015552985 0.99999999999999977795540 ## [2,] -0.00000000000000008326673 -0.00000000000000072901038 ## [3,] 0.00000000000000046490589 0.00000000000000009757103 ## [4,] 0.00000000000000012777427 0.00000000000000029143354 ## [5,] -0.00000000000000078409501 -0.00000000000000055708815 ## [6,] 0.99999999999999955591079 0.00000000000000008086357 ## [7,] 1.00000000000000022204460 0.00000000000000082799624 ## [8,] 0.00000000000000061062266 1.00000000000000155431223 ## [9,] -0.00000000000000018735014 1.00000000000000022204460 ## [10,] 0.00000000000000010408341 0.00000000000000027755576 ## [11,] 0.00000000000000033306691 0.00000000000000073226656 ## [,7] [,8] ## [1,] -0.00000000000000052735594 -0.0000000000000003484733 ## [2,] -0.00000000000000005508464 -0.0000000000000004857226 ## [3,] -0.00000000000000069778535 0.0000000000000001526557 ## [4,] 1.00000000000000133226763 0.0000000000000006954180 ## [5,] 0.00000000000000011993784 -0.0000000000000007632783 ## [6,] 0.00000000000000027995891 0.0000000000000003330669 ## [7,] 0.00000000000000050080194 1.0000000000000013322676 ## [8,] 1.00000000000000111022302 1.0000000000000015543122 ## [9,] 0.00000000000000038857806 0.0000000000000002142383 ## [10,] 1.00000000000000022204460 0.0000000000000005906733 ## [11,] 0.00000000000000026693416 1.0000000000000006661338 plot(m.svd$v, type=&quot;n&quot;) text(m.svd$v[,1], m.svd$v[,2], labels=rownames(tdm), cex= 1.5, family=&quot;Heiti TC Light&quot;) 5.8.6 SVD on dtm m.svd &lt;- svd(dtm) D &lt;- diag(m.svd$d) m.svd$u %*% D %*% t(m.svd$v) # X = U D V&#39; ## [,1] [,2] ## [1,] 0.99999999999999955591079 1.0000000000000000000000 ## [2,] 0.00000000000000004657358 0.9999999999999997779554 ## [3,] -0.00000000000000058780731 1.0000000000000004440892 ## [4,] 0.99999999999999855671007 1.0000000000000002220446 ## [5,] -0.00000000000000033540566 0.0000000000000006383782 ## [6,] 0.99999999999999977795540 -0.0000000000000004518811 ## [7,] 0.00000000000000062450045 0.0000000000000004380033 ## [8,] 0.00000000000000010145579 0.0000000000000006522560 ## [,3] [,4] ## [1,] 1.0000000000000000000000 0.0000000000000007167047 ## [2,] 0.9999999999999996669331 0.9999999999999995559108 ## [3,] -0.0000000000000006477721 1.0000000000000002220446 ## [4,] -0.0000000000000007447772 0.0000000000000008514853 ## [5,] -0.0000000000000003469447 -0.0000000000000003168504 ## [6,] -0.0000000000000002507678 0.0000000000000007771561 ## [7,] 0.0000000000000003479124 0.9999999999999994448885 ## [8,] 0.0000000000000001318390 -0.0000000000000004900338 ## [,5] [,6] ## [1,] -0.00000000000000046125016 -0.0000000000000001036478 ## [2,] 0.00000000000000010953497 -0.0000000000000001669690 ## [3,] 1.00000000000000133226763 0.0000000000000003446392 ## [4,] 1.00000000000000088817842 0.0000000000000003770057 ## [5,] 0.00000000000000047878368 1.0000000000000015543122 ## [6,] -0.00000000000000066735605 -0.0000000000000006217487 ## [7,] -0.00000000000000028327242 -0.0000000000000003774520 ## [8,] -0.00000000000000001387779 -0.0000000000000001110223 ## [,7] [,8] ## [1,] 0.0000000000000001206700 0.00000000000000071697601 ## [2,] -0.0000000000000003301379 -0.00000000000000048278834 ## [3,] 0.0000000000000004389134 -0.00000000000000006451692 ## [4,] 0.0000000000000004241115 0.00000000000000023278509 ## [5,] 1.0000000000000015543122 -0.00000000000000055511151 ## [6,] -0.0000000000000003526040 1.00000000000000066613381 ## [7,] -0.0000000000000010351747 0.99999999999999955591079 ## [8,] 1.0000000000000002220446 0.99999999999999944488849 ## [,9] [,10] ## [1,] 0.00000000000000005124254 0.00000000000000057859848 ## [2,] -0.00000000000000002348696 -0.00000000000000019002042 ## [3,] 0.00000000000000019002042 -0.00000000000000055938013 ## [4,] -0.00000000000000055084290 0.00000000000000058713570 ## [5,] -0.00000000000000048919202 -0.00000000000000034347525 ## [6,] 1.00000000000000088817842 0.00000000000000005551115 ## [7,] 0.00000000000000011102230 0.99999999999999988897770 ## [8,] -0.00000000000000048225313 -0.00000000000000046143644 ## [,11] ## [1,] 0.00000000000000021501986 ## [2,] -0.00000000000000013869203 ## [3,] 0.00000000000000008735116 ## [4,] 0.00000000000000013122400 ## [5,] 0.00000000000000016653345 ## [6,] 0.00000000000000002440308 ## [7,] -0.00000000000000069053690 ## [8,] 1.00000000000000022204460 plot(m.svd$v, type=&quot;n&quot;) text(m.svd$v[,1], m.svd$v[,2], labels=rownames(dtm), cex= 1.5, family=&quot;Heiti TC Light&quot;) 5.8.7 Viz Dim Reduction affmatrix %&gt;% rownames_to_column(var = &quot;w1&quot;) %&gt;% pivot_longer(names_to = &quot;w2&quot;, values_to = &quot;n&quot;, -w1) %&gt;% ggplot() + aes(w1, w2, fill=n) + geom_tile() + th m.svd &lt;- svd(affmatrix) ds &lt;- diag(1/m.svd$d[1:3]) u &lt;- m.svd$u v &lt;- m.svd$v us &lt;- as.matrix(u[, 1:3]) vs &lt;- as.matrix(v[, 1:3]) (m.ginv &lt;- vs %*% ds %*% t(us)) ## [,1] [,2] [,3] [,4] [,5] ## [1,] 0.120614363 -0.089721209 -0.008222734 0.018471534 0.011481087 ## [2,] 0.014921607 -0.008222734 -0.002960170 -0.010419551 0.004397012 ## [3,] -0.017753911 0.109502390 0.011550361 -0.003687427 0.004358705 ## [4,] 0.020192669 -0.012971698 0.004557535 0.035237247 -0.005044012 ## [5,] -0.021835960 0.120614363 0.014921607 0.008135661 0.001713732 ## [6,] 0.001574489 0.112266218 0.035101575 0.128728838 -0.021317289 ## [7,] -0.007551848 0.104599655 -0.002860689 -0.080981933 0.022886292 ## [8,] 0.018538218 -0.003188655 0.006427480 0.039619690 -0.005705802 ## [9,] 0.001713732 0.011481087 0.004397012 0.017832904 -0.002939496 ## [10,] 0.016054232 -0.003196673 -0.002728251 -0.012112178 0.005272039 ## [11,] 0.008135661 0.018471534 -0.010419551 -0.069354249 0.017832904 ## [,6] [,7] [,8] [,9] [,10] ## [1,] 0.112266218 -0.003196673 -0.003188655 0.109502390 0.104599655 ## [2,] 0.035101575 -0.002728251 0.006427480 0.011550361 -0.002860689 ## [3,] 0.021976105 0.012298942 0.022657530 -0.016031295 -0.019199254 ## [4,] -0.031295193 0.006532805 -0.015690612 0.023407137 0.057238335 ## [5,] 0.001574489 0.016054232 0.018538218 -0.017753911 -0.007551848 ## [6,] -0.158347905 0.041362300 -0.036889137 0.021976105 0.157313188 ## [7,] 0.157313188 -0.004346598 0.061309528 -0.019199254 -0.108017077 ## [8,] -0.036889137 0.008627792 -0.015970564 0.022657530 0.061309528 ## [9,] -0.021317289 0.005272039 -0.005705802 0.004358705 0.022886292 ## [10,] 0.041362300 -0.002420348 0.008627792 0.012298942 -0.004346598 ## [11,] 0.128728838 -0.012112178 0.039619690 -0.003687427 -0.080981933 ## [,11] ## [1,] -0.012971698 ## [2,] 0.004557535 ## [3,] 0.023407137 ## [4,] -0.015721576 ## [5,] 0.020192669 ## [6,] -0.031295193 ## [7,] 0.057238335 ## [8,] -0.015690612 ## [9,] -0.005044012 ## [10,] 0.006532805 ## [11,] 0.035237247 m.ginv %&gt;% as_tibble() %&gt;% mutate(w1 = row.names(affmatrix)) %&gt;% pivot_longer(names_to = &quot;w2&quot;, values_to = &quot;n&quot;, -w1) %&gt;% ggplot() + aes(w2, w1, fill=n) + geom_tile() + th + scale_fill_gradient2(low = &quot;blue&quot;, high = &quot;blue&quot;) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
